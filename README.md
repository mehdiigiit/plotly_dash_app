# Plotly Dash App for Analysis of Traffic on an Enterprise Network

This Python code creates a Web app using Plotly Dash. It provides several visualizations to analyze traffic on an enterprise network. The purpose of this analysis is to understand the changes in internal subnets of the network over time. It is currently configured for the University of Calgary's campus network traffic. But it can be adjusted for other enterprise networks. The analysis consists of three parts:

1. Internal subnets of the campus network and the distribution of IPs within each subnet.
2. Categorizing the subnets into groups, each representing a particular sub-community or network.
3. The external entities involved with connections from/to the campus network. 

There is short video demoing the app, available to watch at: https://pages.cpsc.ucalgary.ca/~mehdi.karamollahi/Presentation_Dash.mp4

## Sections

The app consists of 8 sections. Each section requires a specific input file (described below) and provides one or a set of specific visualization(s). The sections are as following:

1. **Source subnets on outgoing connections.** A graph shows 9 different measures (graph types) of outgoing connections from each /24 IP subnet of the campus network. We can transition through time using the play/stop buttons and the slider below the graph, for the times that there was any activity from that subnet. Using a drop-down list we can choose between the measures:

	- Total Bytes
	- Inbound
	- Outbound 
	- Difference
	- Connections
	- Source IPs
	- Target IPs
	- Source Ports
	- Target Ports
	
These measures are input files' columns and are explained below. 

Another drop-down list provides the sorting option of subnets over x-axis.

A numeric option gives us the ability to focus on a specific number of subnets based on our sorting option.

2. **Distribution of the selected subnet in outgoing connections.** This graph is dependent to the previous graph. In the previous graph if we click on a bar that presents a measure for a specific subnet, the dependent graph will be populated and shows the distribution of IPs within the selected subnet based on the selected measure in the drop-down list above the first graph. Similar to the first graph, we can transition through time using the play/stop buttons and the slider below the graph, for the times that there was any activity from that subnet.

3. **Target subnets of incoming connections.** Similar to section 1., only on incoming connections to the subnets.

4. **Distribution of the selected subnet in incoming connections.** Similar to section 2.

5. **Outgoing connections from subnet groups.** This section categorizes the subnets (based on our prior knowledge about campus network configuration) into 12 groups to represent different sub-communities or specific networks. 

6. **Incoming connections to subnet groups.** Similar to section 5., only on incoming connections.

7. **External target organizations of the outgoing connections from groups.** Focusing on top 10 target organizations on outgoing connections from each group, based on the total traffic volume exchanges, this section looks at 6 different measures, using 6 line charts. The measures are: (1) connection counts, (2) total bytes, (3) number of distinct source IPs, (4) number of distinct target IPs, (5) number of distinct source ports, (6) number of distinct target ports.

8. **External source organizations of the incoming connections to group.** Similar to section 7., only on incoming connections.

### The input files are 8 categories. These files are generated by SQL queries running on Zeek Conn logs for 4 weeks. These weeks are chosen from and named after separate months:

1. Feb 2020
2. Apr 2020
3. Sept 2020
4. Sept 2021

The following explains the input files:

1. One CSV file for the distribution of outgoing connections from /24 IP subnets.
2. One CSV file for the distribution of incoming connections to /24 IP subnets. 
3. One CSV file for the distribution of all IPs on outgoing connections.
4. One CSV file for the distribution of all IPs on incoming connections.
5. Twelve CSV files for the outgoing connections from each of the twelve campus groups.
6. Twelve CSV files for the incoming connections to each of the twelve campus groups.
7. Twelve CSV files for each of the twelve campus groups with the top 10 target entities of outgoing connections.
8. Twelve CSV files for each of the twelve campus groups with the top 10 source entities of incoming connections.

**The columns for each file is as follows:**

**I.** For the first input file:

1. Week 
	- either "Feb 2020", "Apr 2020", "Sept 2020", or "Sept 2021".
2. SourceSubnet 
	- an integer between 0-256 for the third octet of /24 IP subnets; 256 represents a subnet outside the campus IP range.
3. Rank\_Conns 
	- rank of each subnet based on the number of outgoing connections from that subnet in a particular week.
4. Connections 
	- number of outgoing connections from each subnet in a particular week.
5. Rank\_out 
	- rank of each subnet based on outbound traffic on outgoing connections from that subnet in a particular week.
6. Outbound 
	- outbound traffic on outgoing connections from a subnet in a particular week.
7. Rank\_In 
	- rank of each subnet based on inbound traffic on outgoing connections from that subnet in a particular week. 
8. Inbound 
	- inbound traffic on outgoing connections from a subnet in a particular week.
9. Rank\_Bytes 
	- rank of each subnet based on total traffic volume on outgoing connections from that subnet in a particular week.
10. TotalBytes 
	- total traffic volume on outgoing connections from a subnet in a particular week.
11. Rank\_Sources 
	- rank of each subnet based on the number of active IPs on outgoing connections from that subnet in a particular week.
12. SourceIPs 
	- number of distinct source IPs on outgoing connections from a subnet in a particular week.
13. Rank\_Targets 
	- rank of each subnet based on the number of distinct target IPs on outgoing connections from a subnet in a particular week.
14. TargetIPs 
	- number of distinct target IPs on outgoing connections from that subnet in a particular week.
15. Rank\_SrcPorts 
	- rank of each subnet based on the number of distinct source ports on outgoing connections from a subnet in a particular week.
16. SourcePorts 
	- number of distinct source ports on outgoing connections from that subnet in a particular week.
17. Rank\_TrgPorts 
	- rank of each subnet based on the number of distinct target ports on outgoing connections from a subnet in a particular week.
18. TargetPorts 
	- number of distinct target ports on outgoing connections from that subnet in a particular week.
19. Difference 
	- difference between inbound and outbound on outgoing connections from a subnet in a particular week.
20. Color 
	- either "out > in" when outbound is more than inbound, or "in > out" when inbound is more than outbound. This column is used for coloring the bars.

**II.** For the second input file:

1. Week 
	- similar to I.1.
2. TargetSubnet 
	- an integer between 0-256 for the third octet of /24 IP subnets; 256 represents a subnet outside the campus IP range.
3. Rank\_Conns 
	- rank of each subnet based on the number of incoming connections to that subnet in a particular week.
4. Connections 
	- number of incoming connections to each subnet in a particular week.
5. Rank\_out 
	- rank of each subnet based on outbound traffic on incoming connections to that subnet in a particular week.
6. Outbound 
	- outbound traffic on incoming connections to a subnet in a particular week.
7. Rank\_In 
	- rank of each subnet based on inbound traffic on incoming connections to that subnet in a particular week. 
8. Inbound 
	- inbound traffic on incoming connections to a subnet in a particular week.
9. Rank\_Bytes 
	- rank of each subnet based on total traffic volume on incoming connections to that subnet in a particular week.
10. TotalBytes 
	- total traffic volume on incoming connections to a subnet in a particular week.
11. Rank\_Sources 
	- rank of each subnet based on the number of active IPs on incoming connections to that subnet in a particular week.
12. SourceIPs 
	- number of distinct source IPs on incoming connections to a subnet in a particular week.
13. Rank\_Targets 
	- rank of each subnet based on the number of distinct target IPs on incoming connections to that subnet in a particular week.
14. TargetIPs 
	- number of distinct target IPs on incoming connections to a subnet in a particular week.
15. Rank\_SrcPorts 
	- rank of each subnet based on the number of distinct source ports on incoming connections to that subnet in a particular week.
16. SourcePorts 
	- number of distinct source ports on incoming connections to a subnet in a particular week.
17. Rank\_TrgPorts 
	- rank of each subnet based on the number of distinct target ports on incoming connections to that subnet in a particular week.
18. TargetPorts 
	- number of distinct target ports on incoming connections to a subnet in a particular week.
19. Difference 
	- difference between inbound and outbound on incoming connections to a subnet in a particular week.
20. Color 
	- similar to I.20.

**III.** For the third input file:

1. Week 
	- similar to I.1.
2. SourceSubnet
	- similar to I.2.
3. SourceIP 
	- an integer between 0-256 for the fourth octet of /24 IP address.
4. Connections
	- similar to I.4.
5. Outbound
	- similar to I.6.
6. Inbound
	- similar to I.8.
7. TotalBytes
	- similar to I.10.
8. TargetIPs
	- similar to I.14.
10. SourcePorts	
	- similar to I.16.
11. TargetPorts
	- similar to I.18.
12. Difference
	- similar to I.19.
13. Color
	- similar to I.20.

**IV.** For the fourth input file:

1. Week 
	- similar to I.1.
2. TargetSubnet
	- similar to II.2.
3. TargetIP 
	- an integer between 0-256 for the fourth octet of /24 IP address.
4. Connections
	- similar to II.4.
5. Outbound
	- similar to II.6.
6. Inbound
	- similar to II.8.
7. TotalBytes
	- similar to II.10.
8. TargetIPs
	- similar to II.14.
10. SourcePorts	
	- similar to II.16.
11. TargetPorts
	- similar to II.18.
12. Difference
	- similar to II.19.
13. Color
	- similar to II.20.

**V.** For the fifth type of input files (12 files):

1. Week
	- similar to I.1.
2. Connections
	- number of outgoing connections from each group in a particular week.
3. Outbound
	- outbound traffic on outgoing connections from a group in a particular week.
4. Inbound
	- inbound traffic on outgoing connections from a group in a particular week.
5. TotalBytes
	- total traffic volume on outgoing connections from a group in a particular week.

**VI.** For the sixth type of input files (12 files):

1. Week
	- similar to I.1.
2. Connections
	- number of incoming connections to each group in a particular week.
3. Outbound
	- outbound traffic on incoming connections to a group in a particular week.
4. Inbound
	- inbound traffic on incoming connections to a group in a particular week.
5. TotalBytes
	- total traffic volume on incoming connections to a group in a particular week.
	
**VII.** For the seventh type of input files (12 files):

1. Week
	- similar to I.1.
2. TargetOrgs
	- top 10 target organizations of outgoing connections from a particular group based on total traffic volume.
3. Connections
	- number of outgoing connections from a particular group to each organization in a particular week.
4. Outbound
	- outbound traffic on outgoing connections from a particular group to each organization in a particular week.
5. Inbound
	- outbound traffic on outgoing connections from a particular group to each organization in a particular week.
6. TotalBytes
	- total traffic of outgoing connections from a particular group to each organization in a particular week.
7. SourceIPs
	- number of distinct source IPs in outgoing connections from a particular group to each organization in a particular week.
8. TargetIPs
	- number of distinct target IPs in outgoing connections from a particular group to each organization in a particular week.
9. SourcePorts
	- number of distinct source ports in outgoing connections from a particular group to each organization in a particular week.
10. TargetPorts
	- number of distinct target ports in outgoing connections from a particular group to each organization in a particular week.

**VIII.** For the eighth type of input files (12 files):

1. Week
	- similar to I.1.
2. SourceOrgs
	- top 10 source organizations of incoming connections to a particular group based on total traffic volume.
3. Connections
	- number of incoming connections from each organization to a particular group in a particular week.
4. Outbound
	- outbound traffic on incoming connections from each organization to a particular group in a particular week.
5. Inbound
	- outbound traffic on incoming connections from each organization to a particular group in a particular week.
6. TotalBytes
	- total traffic of incoming connections from each organization to a particular group in a particular week.
7. SourceIPs
	- number of distinct source IPs in incoming connections from each organization to a particular group in a particular week.
8. TargetIPs
	- number of distinct target IPs in incoming connections from each organization to a particular group in a particular week.
9. SourcePorts
	- number of distinct source ports in incoming connections from each organization to a particular group in a particular week.
10. TargetPorts
	- number of distinct target ports in incoming connections from each organization to a particular group in a particular week.

